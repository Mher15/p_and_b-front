import styled, { keyframes } from "styled-components";
import { ReactNode } from "react";
import { createPortal } from "react-dom";

const rotate = keyframes`
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
`;

const StyledSvg = styled.svg`
  width: 50px;
  height: 50px;
  animation: ${rotate} 3s linear infinite;
`;

const LoaderPortalBackground = styled.div`
  position: absolute;
  top: 0;
  left: 0;
  background: rgb(0, 0, 0, 0.5);
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
`;

interface IPortalProps {
  children: ReactNode;
}

export const LoaderPortal = ({ children }: IPortalProps) => {
  return createPortal(
    <LoaderPortalBackground>{children}</LoaderPortalBackground>,
    document.getElementById("portal")!
  );
};

const LoaderSvg = () => (
  <StyledSvg
    xmlns="http://www.w3.org/2000/svg"
    width="384"
    height="384"
    viewBox="0 0 384 384"
    fill="none"
  >
    <path
      d="M33.751 225.006C15.1411 225.006 0 209.865 0 191.256C0 172.646 15.1411 157.506 33.751 157.506C52.3639 157.506 67.505 172.646 67.505 191.256C67.505 209.865 52.3639 225.006 33.751 225.006ZM177.761 75.0029C157.083 75.0029 140.257 58.1807 140.257 37.5C140.257 16.8223 157.083 0 177.761 0C198.44 0 215.262 16.8223 215.262 37.5C215.262 58.1807 198.44 75.0029 177.761 75.0029ZM177.761 30C173.624 30 170.261 33.3662 170.261 37.5C170.261 41.6367 173.624 45 177.761 45C181.895 45 185.261 41.6367 185.261 37.5C185.261 33.3662 181.895 30 177.761 30ZM75.3802 121.503C65.6622 121.503 56.5271 117.721 49.6568 110.848C42.7865 103.978 39.0012 94.8428 39.0012 85.1279C39.0012 75.4102 42.7865 66.2754 49.6568 59.4053C56.5271 52.5352 65.6622 48.75 75.3802 48.75C85.0954 48.75 94.2304 52.5352 101.104 59.4053C107.974 66.2754 111.756 75.4102 111.756 85.1279C111.756 94.8428 107.974 103.978 101.101 110.851C94.2304 117.721 85.0954 121.503 75.3802 121.503ZM75.3802 78.7529C74.3929 78.7529 72.4973 78.9932 70.8713 80.6191C69.2453 82.2451 69.005 84.1406 69.005 85.1279C69.005 86.1152 69.2453 88.0107 70.8713 89.6338C72.4973 91.2598 74.3929 91.5029 75.3802 91.5029C76.3646 91.5029 78.2631 91.2598 79.8862 89.6367C81.5122 88.0107 81.7554 86.1152 81.7554 85.1279C81.7554 84.1406 81.5123 82.2451 79.8892 80.6191H79.8862C78.2631 78.9932 76.3646 78.7529 75.3802 78.7529ZM286.893 123.003C275.774 123.003 265.321 118.673 257.457 110.812C249.594 102.949 245.263 92.4961 245.263 81.3779C245.263 70.2598 249.594 59.8066 257.457 51.9434C265.321 44.0801 275.774 39.75 286.893 39.75C298.011 39.75 308.464 44.0801 316.328 51.9434C324.189 59.8066 328.519 70.2598 328.519 81.3779C328.519 92.4961 324.189 102.949 316.328 110.812C308.464 118.673 298.011 123.003 286.893 123.003ZM286.893 69.7529C283.787 69.7529 280.869 70.96 278.672 73.1572C276.477 75.3545 275.267 78.2725 275.267 81.3779C275.267 84.4834 276.474 87.4014 278.672 89.5957C280.869 91.793 283.787 93.0029 286.893 93.0029C289.998 93.0029 292.916 91.793 295.111 89.5986C297.308 87.4014 298.518 84.4834 298.518 81.3779C298.518 78.2725 297.308 75.3545 295.111 73.1572C292.916 70.96 289.998 69.7529 286.893 69.7529ZM335.269 239.235C322.785 239.235 310.301 234.483 300.797 224.98C281.786 205.972 281.786 175.04 300.797 156.032C319.806 137.024 350.735 137.024 369.744 156.032C388.752 175.04 388.752 205.972 369.744 224.98C360.24 234.483 347.756 239.235 335.269 239.235ZM335.269 171.765C330.467 171.765 325.665 173.593 322.012 177.246C314.699 184.559 314.699 196.453 322.012 203.766C329.322 211.075 341.216 211.075 348.529 203.766C355.839 196.453 355.839 184.559 348.529 177.246C344.873 173.593 340.071 171.765 335.269 171.765ZM287.268 363.735C274.013 363.735 260.762 358.693 250.672 348.604C230.494 328.427 230.494 295.594 250.672 275.417C270.849 255.237 303.683 255.237 323.86 275.417C344.041 295.594 344.041 328.427 323.86 348.604C313.773 358.693 300.519 363.735 287.268 363.735ZM287.268 290.268C281.698 290.268 276.129 292.389 271.886 296.628C263.407 305.109 263.407 318.908 271.886 327.39C280.368 335.871 294.167 335.871 302.649 327.39C311.128 318.908 311.128 305.109 302.649 296.628C298.407 292.389 292.837 290.268 287.268 290.268ZM69.3771 329.244C61.0243 329.244 52.6686 326.063 46.3081 319.705C33.587 306.981 33.587 286.283 46.3081 273.562C59.0291 260.842 79.728 260.842 92.4491 273.562C105.17 286.283 105.17 306.981 92.4491 319.702C86.0886 326.062 77.7328 329.244 69.3771 329.244ZM157.508 384C151.745 384 145.985 381.809 141.599 377.423C132.824 368.648 132.824 354.372 141.596 345.601L141.599 345.598C150.371 336.826 164.648 336.826 173.419 345.598C182.194 354.372 182.194 368.648 173.422 377.42C169.033 381.806 163.271 384 157.508 384Z"
      fill="url(#paint0_linear_1350_9123)"
    />
    <defs>
      <linearGradient
        id="paint0_linear_1350_9123"
        x1="192"
        y1="0"
        x2="192"
        y2="384"
        gradientUnits="userSpaceOnUse"
      >
        <stop stopColor="#B3DB11" />
        <stop offset="1" stopColor="#FCA600" />
      </linearGradient>
    </defs>
  </StyledSvg>
);

export const Loader = () => (
  <LoaderPortal>
    <LoaderSvg />
  </LoaderPortal>
);
